export HOMEBREW_INSTALL_CLEANUP=1

# Alias for brew upgrading
function bubu {
  TERM="xterm-256color"

  local reset
  local bold
  local icon
  local cmd_style
  local verbose

  reset="$(tput sgr0)"
  bold="$(tput bold)"
  icon="➥"
  cmd_style="$(tput setaf 102)"

  if [[ "$1" == "-v" || "$1" == "--verbose" ]] ; then
    verbose='--verbose'
  else
    verbose=''
  fi

  function __bubu_banner {
    local timestamp;
    local color;
    local ico;
    local msg;

    timestamp="$(date '+%b %d @ %I:%M:%S %p')"
    color="$(tput setaf ${1})"
    ico="${3:-"${icon}"}"
    msg="$2"

    printf "%s%s%s %s%s%s %s%s%s \n" \
      "${color}${bold}" "$ico" "$reset" \
      "$color" "$msg" "$reset" \
      "$cmd_style" "$timestamp" "$reset"
  }

  function __bubu_cmd {
    printf "%s  $ %s %s \n" \
      "$cmd_style" \
      "$1" \
      "$reset"

    eval "$1"

    echo
  }

  __bubu_banner 5 "Update"
  __bubu_cmd "brew update ${verbose}"

  __bubu_banner 5 "Upgrade"
  __bubu_cmd "brew upgrade --display-times"

  __bubu_banner 4 "Cleanup"
  __bubu_cmd "brew cleanup"

  __bubu_banner 1 "$(tput setaf 3)Done" "☭"
}

alias cbubu='clear ; bubu'
